name: CI


on:
  push:
    branches: [ "master" ]

  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3
      
      - name: Setup pnpm
        uses: pnpm/action-setup@v2.2.2
        with:
          version: '7.11.0'

      - name: install deps
        run: pnpm install
        

      - name: copy dist to zzall.github.io
        run: |
          echo 到123
          
          
          
  Post:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: post to tencent centos services
        run: |
          echo ls之前：
          ls
          echo 之后的是：
          apt-get -v
          sshpass -v
          # apt-get  install sshpass
          echo 已安装sshpass~
          sshpass -p ${{ secrets.TENCENT_CENTOS_PASSWORD }} scp ./* root@150.158.182.28:/root/node-services/testDeploy
          echo 已上传成功~
          
      - name: SSHPASS Github Action
        # You may pin to the exact commit or the version.
        # uses: matheusvanzan/sshpass-action@1e96f05518c2e99d17587ee85fa4d64c1612d0f1
        uses: matheusvanzan/sshpass-action@v1
        with:
          # SSHPASS host
          host: 150.158.182.28
          # SSHPASS username
          username: ${{ secrets.TENCENT_CENTOS_USERNAME }}
          # SSHPASS password
          password: ${{ secrets.TENCENT_CENTOS_PASSWORD }}
          # SSHPASS commands to run
          run: scp ./* root@150.158.182.28:/root/node-services/testDeploy
        
